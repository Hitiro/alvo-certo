<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consultar Empresas</title>
    <link rel="stylesheet" href="consultar-empresas.css">
</head>
<body>
    <div class="container">
        <h1>Consultar Empresas</h1>
        <form id="consulta-empresas-form">
            <div class="search-group">
                <label for="search-key">Chaves de Busca:</label>
                <select id="search-key" name="search-key" class="small-select">
                    <option value="cnpj">CNPJ</option>
                    <option value="nome">Nome</option>
                    <option value="email">E-mail</option>
                    <option value="telefone">Telefone</option>
                </select>
            </div>
            <div class="input-group">
                <input type="text" id="search-input" name="search-input" placeholder="Digite aqui...">
            </div>
            <button type="submit">Buscar</button>
        </form>
    </div>
    <script>
        const searchKey = document.getElementById('search-key');
        const searchInput = document.getElementById('search-input');

        searchKey.addEventListener('change', function () {
            if (this.value === 'cnpj') {
                searchInput.placeholder = 'Digite o CNPJ...';
                searchInput.maxLength = 18;
                searchInput.value = '';
                searchInput.addEventListener('input', formatCNPJ);
                searchInput.removeEventListener('input', convertToUpperCase);
                searchInput.removeEventListener('input', formatPhone);
            } else if (this.value === 'nome') {
                searchInput.placeholder = 'RazÃ£o social ou nome fantasia da empresa...';
                searchInput.maxLength = 100;
                searchInput.addEventListener('input', convertToUpperCase);
                searchInput.removeEventListener('input', formatCNPJ);
                searchInput.removeEventListener('input', formatPhone);
            } else if (this.value === 'email') {
                searchInput.placeholder = 'nome@exemplo.com';
                searchInput.maxLength = 50;
                searchInput.removeEventListener('input', formatCNPJ);
                searchInput.removeEventListener('input', convertToUpperCase);
                searchInput.removeEventListener('input', formatPhone);
            } else if (this.value === 'telefone') {
                searchInput.placeholder = '(00) 00000-0000';
                searchInput.maxLength = 15;
                searchInput.addEventListener('input', formatPhone);
                searchInput.removeEventListener('input', formatCNPJ);
                searchInput.removeEventListener('input', convertToUpperCase);
            }
        });

        document.getElementById('consulta-empresas-form').addEventListener('submit', function (event) {
            event.preventDefault();
            const searchInputVal = searchInput.value.trim();
            const searchKeyVal = searchKey.value;

            if (searchInputVal === '') {
                let message = '';
                if (searchKeyVal === 'cnpj') {
                    message = 'Por favor, preencha o campo do CNPJ.';
                } else if (searchKeyVal === 'nome') {
                    message = 'Por favor, preencha o campo do Nome.';
                } else if (searchKeyVal === 'email') {
                    message = 'Por favor, preencha o campo do E-mail.';
                } else if (searchKeyVal === 'telefone') {
                    message = 'Por favor, preencha o campo do Telefone.';
                }
                alert(message);
                return;
            }
            window.location.href = 'consulta-empresas-resultados.html';
        });

        function formatCNPJ() {
            let input = searchInput.value.replace(/\D/g, '');
            if (input.length > 14) {
                input = input.substring(0, 14);
            }
            const part1 = input.substring(0, 2);
            const part2 = input.substring(2, 5);
            const part3 = input.substring(5, 8);
            const part4 = input.substring(8, 12);
            const part5 = input.substring(12, 14);
            if (input.length > 12) {
                searchInput.value = `${part1}.${part2}.${part3}/${part4}-${part5}`;
            } else if (input.length > 8) {
                searchInput.value = `${part1}.${part2}.${part3}/${part4}`;
            } else if (input.length > 5) {
                searchInput.value = `${part1}.${part2}.${part3}`;
            } else if (input.length > 2) {
                searchInput.value = `${part1}.${part2}`;
            } else if (input.length > 0) {
                searchInput.value = `${part1}`;
            }
        }

        function convertToUpperCase() {
            searchInput.value = searchInput.value.toUpperCase();
        }

        function formatPhone() {
            let input = searchInput.value.replace(/\D/g, '');
            if (input.length > 11) {
                input = input.substring(0, 11);
            }
            const part1 = input.substring(0, 2);
            const part2 = input.substring(2, 7);
            const part3 = input.substring(7, 11);
            if (input.length > 7) {
                searchInput.value = `(${part1}) ${part2}-${part3}`;
            } else if (input.length > 2) {
                searchInput.value = `(${part1}) ${part2}`;
            } else if (input.length > 0) {
                searchInput.value = `(${part1}`;
            }
        }
    </script>
</body>
</html>
